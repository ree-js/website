async function Q(e){let t={},r=e.headers.get("Content-Type");if(r&&(r.startsWith("multipart/form-data")||r==="application/x-www-form-urlencoded")){let s={};(await e.formData()).forEach((i,n)=>{s[n]=i}),t=s}return t}var X=e=>{let t=e.split("/");return t[0]===""&&t.shift(),t},Z=e=>{let t=[];for(let s=0;;){let i=!1;if(e=e.replace(/\{[^}]+\}/g,n=>{let o=`@\\${s}`;return t[s]=[o,n],s++,i=!0,o}),!i)break}let r=e.split("/");r[0]===""&&r.shift();for(let s=t.length-1;s>=0;s--){let[i]=t[s];for(let n=r.length-1;n>=0;n--)if(r[n].indexOf(i)!==-1){r[n]=r[n].replace(i,t[s][1]);break}}return r},E={},ee=e=>{if(e==="*")return"*";let t=e.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);return t?(E[e]||(t[2]?E[e]=[e,t[1],new RegExp("^"+t[2]+"$")]:E[e]=[e,t[1],!0]),E[e]):null},I=e=>{let t=e.url,r=t.indexOf("?",8);return t.slice(t.indexOf("/",8),r===-1?void 0:r)},te=e=>{let t=I(e);return t.length>1&&t[t.length-1]==="/"?t.slice(0,-1):t},x=(...e)=>{let t="",r=!1;for(let s of e)t[t.length-1]==="/"&&(t=t.slice(0,-1),r=!0),s[0]!=="/"&&(s=`/${s}`),s==="/"&&r?t=`${t}/`:s!=="/"&&(t=`${t}${s}`),s==="/"&&t===""&&(t="/");return t},L=e=>{let t=e.match(/^(.+|)(\/\:[^\/]+)\?$/);if(!t)return null;let r=t[1],s=r+t[2];return[r===""?"/":r.replace(/\/$/,""),s]},F=e=>/[%+]/.test(e)?(e.indexOf("+")!==-1&&(e=e.replace(/\+/g," ")),e.indexOf("%")===-1?e:O(e)):e,B=(e,t,r)=>{let s;if(!r&&t&&!/[%+]/.test(t)){let o=e.indexOf(`?${t}`,8);for(o===-1&&(o=e.indexOf(`&${t}`,8));o!==-1;){let a=e.charCodeAt(o+t.length+1);if(a===61){let l=o+t.length+2,h=e.indexOf("&",l);return F(e.slice(l,h===-1?void 0:h))}else if(a==38||isNaN(a))return"";o=e.indexOf(`&${t}`,o+1)}if(s=/[%+]/.test(e),!s)return}let i={};s??(s=/[%+]/.test(e));let n=e.indexOf("?",8);for(;n!==-1;){let o=e.indexOf("&",n+1),a=e.indexOf("=",n);a>o&&o!==-1&&(a=-1);let l=e.slice(n+1,a===-1?o===-1?void 0:o:a);if(s&&(l=F(l)),n=o,l==="")continue;let h;a===-1?h="":(h=e.slice(a+1,o===-1?void 0:o),s&&(h=F(h))),r?(i[l]??(i[l]=[])).push(h):i[l]??(i[l]=h)}return t?i[t]:i},re=B,se=(e,t)=>B(e,t,!0),O=decodeURIComponent,ie=e=>{let t=e.split(/;\s*/g),r={};for(let s=0,i=t.length;s<i;s++){let n=t[s].split(/\s*=\s*([^\s]+)/);r[n[0]]=O(n[1])}return r},ne=(e,t,r={})=>{t=encodeURIComponent(t);let s=`${e}=${t}`;return r.maxAge&&(s+=`; Max-Age=${Math.floor(r.maxAge)}`),r.domain&&(s+="; Domain="+r.domain),r.path&&(s+="; Path="+r.path),r.expires&&(s+="; Expires="+r.expires.toUTCString()),r.httpOnly&&(s+="; HttpOnly"),r.secure&&(s+="; Secure"),r.sameSite&&(s+=`; SameSite=${r.sameSite}`),s},he=class{constructor(e,t="/",r){this.raw=e,this.path=t,this.paramData=r,this.vData={}}param(e){if(this.paramData)if(e){let t=this.paramData[e];return t?/\%/.test(t)?O(t):t:void 0}else{let t={};for(let[r,s]of Object.entries(this.paramData))s&&typeof s=="string"&&(t[r]=/\%/.test(s)?O(s):s);return t}return null}query(e){return re(this.url,e)}queries(e){return se(this.url,e)}header(e){let t={};return this.raw.headers.forEach((r,s)=>{t[s]=r}),e?t[e.toLowerCase()]:t}cookie(e){let t=this.raw.headers.get("Cookie");if(!t)return;let r=ie(t);return e?r[e]:r}async parseBody(){return await Q(this.raw)}json(){return this.raw.json()}text(){return this.raw.text()}arrayBuffer(){return this.raw.arrayBuffer()}blob(){return this.raw.blob()}formData(){return this.raw.formData()}addValidatedData(e,t){this.vData[e]=t}valid(e){if(e)return this.vData[e]}get url(){return this.raw.url}get method(){return this.raw.method}get headers(){return this.raw.headers}get redirect(){return this.raw.redirect}get body(){return this.raw.body}get bodyUsed(){return this.raw.bodyUsed}get cache(){return this.raw.cache}get credentials(){return this.raw.credentials}get integrity(){return this.raw.integrity}get keepalive(){return this.raw.keepalive}get mode(){return this.raw.mode}get referrer(){return this.raw.referrer}get refererPolicy(){return this.raw.referrerPolicy}get signal(){return this.raw.signal}},H=class{constructor(e,t){this.env={},this.finalized=!1,this.error=void 0,this._status=200,this._pre=!1,this._preS=2,this._h=void 0,this._pH=void 0,this._path="/",this.notFoundHandler=()=>new Response,this.header=(r,s,i)=>{if(s===void 0){this._h?this._h.delete(r):this._pH&&delete this._pH[r.toLocaleLowerCase()],this.finalized&&this.res.headers.delete(r);return}i?.append?(this._h||(this._h=new Headers(this._pH),this._pH={}),this._h.append(r,s)):this._h?this._h.set(r,s):(this._pH??(this._pH={}),this._pH[r.toLowerCase()]=s),this.finalized&&(i?.append?this.res.headers.append(r,s):this.res.headers.set(r,s))},this.status=r=>{this._status=r},this.set=(r,s)=>{this._map||(this._map={}),this._map[r]=s},this.get=r=>this._map?this._map[r]:void 0,this.pretty=(r,s=2)=>{this._pre=r,this._preS=s},this.newResponse=(r,s,i)=>{if(!i&&!this._h&&!this._res&&!s&&this._status===200)return new Response(r,{headers:this._pH});if(s&&typeof s!="number"){let o=new Response(r,s),a=this._pH?.["content-type"];return a&&o.headers.set("content-type",a),o}let n=s??this._status;this._pH??(this._pH={}),this._h??(this._h=new Headers);for(let[o,a]of Object.entries(this._pH))this._h.set(o,a);if(this._res){this._res.headers.forEach((o,a)=>{this._h?.set(a,o)});for(let[o,a]of Object.entries(this._pH))this._h.set(o,a)}i??(i={});for(let[o,a]of Object.entries(i))if(typeof a=="string")this._h.set(o,a);else{this._h.delete(o);for(let l of a)this._h.append(o,l)}return new Response(r,{status:n,headers:this._h})},this.body=(r,s,i)=>typeof s=="number"?this.newResponse(r,s,i):this.newResponse(r,s),this.text=(r,s,i)=>{if(!this._pH){if(!i&&!this._res&&!this._h&&!s)return new Response(r);this._pH={}}return this._pH["content-type"]&&(this._pH["content-type"]="text/plain; charset=UTF-8"),typeof s=="number"?this.newResponse(r,s,i):this.newResponse(r,s)},this.json=(r,s,i)=>{let n=this._pre?JSON.stringify(r,null,this._preS):JSON.stringify(r);return this._pH??(this._pH={}),this._pH["content-type"]="application/json; charset=UTF-8",typeof s=="number"?this.newResponse(n,s,i):this.newResponse(n,s)},this.jsonT=(r,s,i)=>({response:typeof s=="number"?this.json(r,s,i):this.json(r,s),data:r,format:"json"}),this.html=(r,s,i)=>(this._pH??(this._pH={}),this._pH["content-type"]="text/html; charset=UTF-8",typeof s=="number"?this.newResponse(r,s,i):this.newResponse(r,s)),this.redirect=(r,s=302)=>(this._h??(this._h=new Headers),this._h.set("Location",r),this.newResponse(null,s)),this.cookie=(r,s,i)=>{let n=ne(r,s,i);this.header("set-cookie",n,{append:!0})},this.notFound=()=>this.notFoundHandler(this),this.rawRequest=e,t&&(this._exCtx=t.executionCtx,this._path=t.path??"/",this._params=t.params,this.env=t.env,t.notFoundHandler&&(this.notFoundHandler=t.notFoundHandler))}get req(){return this._req?this._req:(this._req=new he(this.rawRequest,this._path,this._params),this.rawRequest=void 0,this._params=void 0,this._req)}get event(){if(this._exCtx instanceof FetchEvent)return this._exCtx;throw Error("This context has no FetchEvent")}get executionCtx(){if(this._exCtx)return this._exCtx;throw Error("This context has no ExecutionContext")}get res(){return this._res||(this._res=new Response("404 Not Found",{status:404}))}set res(e){this._res&&e&&(this._res.headers.delete("content-type"),this._res.headers.forEach((t,r)=>{e.headers.set(r,t)})),this._res=e,this.finalized=!0}get runtime(){let e=globalThis;return e?.Deno!==void 0?"deno":e?.Bun!==void 0?"bun":typeof e?.WebSocketPair=="function"?"workerd":typeof e?.EdgeRuntime=="string"?"edge-light":e?.fastly!==void 0?"fastly":e?.__lagon__!==void 0?"lagon":e?.process?.release?.name==="node"?"node":"other"}},A=(e,t,r)=>{let s=e.length;return(i,n)=>{let o=-1;return a(0);function a(l){if(l<=o)throw new Error("next() called multiple times");let h=e[l];o=l,l===s&&n&&(h=n);let u,c=!1;if(!h)i instanceof H&&i.finalized===!1&&r&&(u=r(i));else try{u=h(i,()=>{let d=a(l+1);return d instanceof Promise?d:Promise.resolve(d)})}catch(d){if(d instanceof Error&&i instanceof H&&t)i.error=d,u=t(d,i),c=!0;else throw d}return u instanceof Promise?u.then(d=>(d!==void 0&&"response"in d&&(d=d.response),d&&i.finalized===!1&&(i.res=d),i)).catch(async d=>{if(d instanceof Error&&i instanceof H&&t)return i.error=d,i.res=await t(d,i),i;throw d}):(u!==void 0&&"response"in u&&(u=u.response),u&&(i.finalized===!1||c)&&(i.res=u),i)}}},ae=class extends Error{constructor(e=500,t){super(t?.message),this.res=t?.res,this.status=e}getResponse(){return this.res?this.res:new Response(this.message,{status:this.status})}},p="ALL",oe="all",M=["get","post","put","delete","options","patch"],W=class extends Error{};function le(){return class{}}var ue=e=>e.text("404 Not Found",404),N=(e,t)=>{if(e instanceof ae)return e.getResponse();console.trace(e);let r="Internal Server Error";return t.text(r,500)},G=class extends le(){constructor(e={}){super(),this._basePath="",this.path="*",this.routes=[],this.notFoundHandler=ue,this.errorHandler=N,this.head=()=>(console.warn("`app.head()` is no longer used. `app.get()` implicitly handles the HEAD method."),this),this.handleEvent=r=>this.dispatch(r.request,r,void 0,r.request.method),this.fetch=(r,s,i)=>this.dispatch(r,i,s,r.method),this.request=async(r,s)=>{if(r instanceof Request)return s!==void 0&&(r=new Request(r,s)),await this.fetch(r);r=r.toString();let i=/^https?:\/\//.test(r)?r:`http://localhost${x("/",r)}`,n=new Request(i,s);return await this.fetch(n)},this.fire=()=>{addEventListener("fetch",r=>{r.respondWith(this.handleEvent(r))})},[...M,oe].map(r=>{this[r]=(s,...i)=>(typeof s=="string"?this.path=s:this.addRoute(r,this.path,s),i.map(n=>{typeof n!="string"&&this.addRoute(r,this.path,n)}),this)}),this.on=(r,s,...i)=>{if(!r)return this;this.path=s;for(let n of[r].flat())i.map(o=>{this.addRoute(n.toUpperCase(),this.path,o)});return this},this.use=(r,...s)=>(typeof r=="string"?this.path=r:s.unshift(r),s.map(i=>{this.addRoute(p,this.path,i)}),this);let t=e.strict??!0;delete e.strict,Object.assign(this,e),this.getPath||(this.getPath=t?I:te)}clone(){let e=new G({router:this.router,getPath:this.getPath});return e.routes=this.routes,e}route(e,t){let r=this.basePath(e);return t?(t.routes.map(s=>{let i=t.errorHandler===N?s.handler:async(n,o)=>(await A([s.handler],t.errorHandler)(n,o)).res;r.addRoute(s.method,s.path,i)}),this):r}basePath(e){let t=this.clone();return t._basePath=x(this._basePath,e),t}onError(e){return this.errorHandler=e,this}notFound(e){return this.notFoundHandler=e,this}showRoutes(){this.routes.map(e=>{console.log(`\x1B[32m${e.method}\x1B[0m ${" ".repeat(8-e.method.length)} ${e.path}`)})}mount(e,t,r){let s=x(this._basePath,e),i=s==="/"?0:s.length,n=async(o,a)=>{let l;try{l=o.executionCtx}catch{}let h=r?r(o):[o.env,l],u=Array.isArray(h)?h:[h],c=await t(new Request(new URL(o.req.path.slice(i)||"/",o.req.url),o.req.raw),...u);if(c)return c;await a()};return this.addRoute(p,x(e,"*"),n),this}get routerName(){return this.matchRoute("GET","/"),this.router.name}addRoute(e,t,r){e=e.toUpperCase(),this._basePath&&(t=x(this._basePath,t)),this.router.add(e,t,r);let s={path:t,method:e,handler:r};this.routes.push(s)}matchRoute(e,t){return this.router.match(e,t)||{handlers:[],params:{}}}handleError(e,t){if(e instanceof Error)return this.errorHandler(e,t);throw e}dispatch(e,t,r,s){let i=this.getPath(e);if(s==="HEAD")return(async()=>new Response(null,await this.dispatch(e,t,r,"GET")))();let{handlers:n,params:o}=this.matchRoute(s,i),a=new H(e,{env:r,executionCtx:t,notFoundHandler:this.notFoundHandler,path:i,params:o});if(n.length===1){let h;try{if(h=n[0](a,async()=>{}),!h)return this.notFoundHandler(a)}catch(u){return this.handleError(u,a)}return h instanceof Response||("response"in h&&(h=h.response),h instanceof Response)?h:(async()=>{let u;try{if(u=await h,u!==void 0&&"response"in u&&(u=u.response),!u)return this.notFoundHandler(a)}catch(c){return this.handleError(c,a)}return u})()}let l=A(n,this.errorHandler,this.notFoundHandler);return(async()=>{try{let h=l(a),u=h instanceof Promise?await h:h;if(!u.finalized)throw new Error("Context is not finalized. You may forget returning Response object or `await next()`");return u.res}catch(h){return this.handleError(h,a)}})()}},j="[^/]+",v=".*",b="(?:|/.*)",$=Symbol();function de(e,t){return e.length===1?t.length===1?e<t?-1:1:-1:t.length===1||e===v||e===b?1:t===v||t===b?-1:e===j?1:t===j?-1:e.length===t.length?e<t?-1:1:t.length-e.length}var q=class{constructor(){this.children={}}insert(e,t,r,s,i){if(e.length===0){if(this.index!==void 0)throw $;if(i)return;this.index=t;return}let[n,...o]=e,a=n==="*"?o.length===0?["","",v]:["","",j]:n==="/*"?["","",b]:n.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),l;if(a){let h=a[1],u=a[2]||j;if(l=this.children[u],!l){if(Object.keys(this.children).some(c=>c!==v&&c!==b))throw $;if(i)return;l=this.children[u]=new q,h!==""&&(l.varIndex=s.varIndex++)}if(!i&&h!==""){if(r.some(c=>c[0]===h))throw new Error("Duplicate param name");r.push([h,l.varIndex])}}else if(l=this.children[n],!l){if(Object.keys(this.children).some(h=>h.length>1&&h!==v&&h!==b))throw $;if(i)return;l=this.children[n]=new q}l.insert(o,t,r,s,i)}buildRegExpStr(){let e=Object.keys(this.children).sort(de).map(t=>{let r=this.children[t];return(typeof r.varIndex=="number"?`(${t})@${r.varIndex}`:t)+r.buildRegExpStr()});return typeof this.index=="number"&&e.unshift(`#${this.index}`),e.length===0?"":e.length===1?e[0]:"(?:"+e.join("|")+")"}},ce=class{constructor(){this.context={varIndex:0},this.root=new q}insert(e,t,r){let s=[],i=[];for(let o=0;;){let a=!1;if(e=e.replace(/\{[^}]+\}/g,l=>{let h=`@\\${o}`;return i[o]=[h,l],o++,a=!0,h}),!a)break}let n=e.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let o=i.length-1;o>=0;o--){let[a]=i[o];for(let l=n.length-1;l>=0;l--)if(n[l].indexOf(a)!==-1){n[l]=n[l].replace(a,i[o][1]);break}}return this.root.insert(n,t,s,this.context,r),s}buildRegExp(){let e=this.root.buildRegExpStr();if(e==="")return[/^$/,[],[]];let t=0,r=[],s=[];return e=e.replace(/#(\d+)|@(\d+)|\.\*\$/g,(i,n,o)=>typeof n<"u"?(r[++t]=Number(n),"$()"):(typeof o<"u"&&(s[Number(o)]=++t),"")),[new RegExp(`^${e}`),r,s]}},P=[p,...M].map(e=>e.toUpperCase()),z={},pe=[/^$/,[],{}],D={};function J(e){return D[e]??(D[e]=new RegExp(e==="*"?"":`^${e.replace(/\/\*/,"(?:|/.*)")}$`))}function fe(){D={}}function me(e){let t=new ce,r=[];if(e.length===0)return pe;let s=e.map(h=>[!/\*|\/:/.test(h[0]),...h]).sort(([h,u],[c,d])=>h?1:c?-1:u.length-d.length),i={};for(let h=0,u=-1,c=s.length;h<c;h++){let[d,f,w]=s[h];d?i[f]={handlers:w,params:z}:u++;let m;try{m=t.insert(f,u,d)}catch(g){throw g===$?new W(f):g}d||(r[u]=m.length===0?[{handlers:w,params:z},null]:[w,m])}let[n,o,a]=t.buildRegExp();for(let h=0,u=r.length;h<u;h++){let c=r[h][1];if(c)for(let d=0,f=c.length;d<f;d++)c[d][1]=a[c[d][1]]}let l=[];for(let h in o)l[h]=r[o[h]];return[n,l,i]}function _(e,t){if(e){for(let r of Object.keys(e).sort((s,i)=>i.length-s.length))if(J(r).test(t))return[...e[r]]}}var ge=class{constructor(){this.name="RegExpRouter",this.middleware={[p]:{}},this.routes={[p]:{}}}add(e,t,r){var s;let{middleware:i,routes:n}=this;if(!i||!n)throw new Error("Can not add a route since the matcher is already built.");if(P.indexOf(e)===-1&&P.push(e),i[e]||[i,n].forEach(a=>{a[e]={},Object.keys(a[p]).forEach(l=>{a[e][l]=[...a[p][l]]})}),t==="/*"&&(t="*"),/\*$/.test(t)){let a=J(t);e===p?Object.keys(i).forEach(l=>{var h;(h=i[l])[t]||(h[t]=_(i[l],t)||_(i[p],t)||[])}):(s=i[e])[t]||(s[t]=_(i[e],t)||_(i[p],t)||[]),Object.keys(i).forEach(l=>{(e===p||e===l)&&Object.keys(i[l]).forEach(h=>{a.test(h)&&i[l][h].push(r)})}),Object.keys(n).forEach(l=>{(e===p||e===l)&&Object.keys(n[l]).forEach(h=>a.test(h)&&n[l][h].push(r))});return}let o=L(t)||[t];for(let a=0,l=o.length;a<l;a++){let h=o[a];Object.keys(n).forEach(u=>{var c;(e===p||e===u)&&((c=n[u])[h]||(c[h]=[..._(i[u],h)||_(i[p],h)||[]]),n[u][h].push(r))})}}match(e,t){fe();let r=this.buildAllMatchers();return this.match=(s,i)=>{let n=r[s],o=n[2][i];if(o)return o;let a=i.match(n[0]);if(!a)return null;let l=a.indexOf("",1),[h,u]=n[1][l];if(!u)return h;let c={};for(let d=0,f=u.length;d<f;d++)c[u[d][0]]=a[u[d][1]];return{handlers:h,params:c}},this.match(e,t)}buildAllMatchers(){let e={};return P.forEach(t=>{e[t]=this.buildMatcher(t)||e[p]}),this.middleware=this.routes=void 0,e}buildMatcher(e){let t=[],r=e===p;return[this.middleware,this.routes].forEach(s=>{let i=s[e]?Object.keys(s[e]).map(n=>[n,s[e][n]]):[];i.length!==0?(r||(r=!0),t.push(...i)):e!==p&&t.push(...Object.keys(s[p]).map(n=>[n,s[p][n]]))}),r?me(t):null}},we=class{constructor(e){this.name="SmartRouter",this.routers=[],this.routes=[],Object.assign(this,e)}add(e,t,r){if(!this.routes)throw new Error("Can not add a route since the matcher is already built.");this.routes.push([e,t,r])}match(e,t){if(!this.routes)throw new Error("Fatal error");let{routers:r,routes:s}=this,i=r.length,n=0,o;for(;n<i;n++){let a=r[n];try{s.forEach(l=>{a.add(...l)}),o=a.match(e,t)}catch(l){if(l instanceof W)continue;throw l}this.match=a.match.bind(a),this.routers=[a],this.routes=void 0;break}if(n===i)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,o||null}get activeRouter(){if(this.routes||this.routers.length!==1)throw new Error("No active router has been determined yet.");return this.routers[0]}};function V(e,t){for(let s=0,i=e.patterns.length;s<i;s++)if(typeof e.patterns[s]=="object"&&e.patterns[s][1]===t)return!0;let r=Object.values(e.children);for(let s=0,i=r.length;s<i;s++)if(V(r[s],t))return!0;return!1}var Y=class{constructor(e,t,r){if(this.order=0,this.children=r||{},this.methods=[],this.name="",e&&t){let s={};s[e]={handler:t,score:0,name:this.name},this.methods=[s]}this.patterns=[],this.handlerSetCache={}}insert(e,t,r){this.name=`${e} ${t}`,this.order=++this.order;let s=this,i=Z(t),n=[],o=h=>`Duplicate param name, use another name instead of '${h}' - ${e} ${t} <--- '${h}'`;for(let h=0,u=i.length;h<u;h++){let c=i[h];if(Object.keys(s.children).includes(c)){n.push(...s.patterns),s=s.children[c];continue}s.children[c]=new Y;let d=ee(c);if(d){if(typeof d=="object"){for(let f=0,w=n.length;f<w;f++)if(typeof n[f]=="object"&&n[f][1]===d[1])throw new Error(o(d[1]));if(Object.values(s.children).some(f=>V(f,d[1])))throw new Error(o(d[1]))}s.patterns.push(d),n.push(...s.patterns)}n.push(...s.patterns),s=s.children[c]}s.methods.length||(s.methods=[]);let a={},l={handler:r,name:this.name,score:this.order};return a[e]=l,s.methods.push(a),s}gHSets(e,t,r){var s,i;return(s=e.handlerSetCache)[i=`${t}:${r?"1":"0"}`]||(s[i]=(()=>{let n=[];for(let o=0,a=e.methods.length;o<a;o++){let l=e.methods[o],h=l[t]||l[p];h!==void 0&&n.push(h)}return n})())}search(e,t){let r=[],s={},i=[this],n=X(t);for(let a=0,l=n.length;a<l;a++){let h=n[a],u=a===l-1,c=[],d=!1;for(let f=0,w=i.length;f<w;f++){let m=i[f],g=m.children[h];g&&(u===!0?(g.children["*"]&&r.push(...this.gHSets(g.children["*"],e,!0)),r.push(...this.gHSets(g,e)),d=!0):c.push(g));for(let S=0,K=m.patterns.length;S<K;S++){let T=m.patterns[S];if(T==="*"){let C=m.children["*"];C&&(r.push(...this.gHSets(C,e)),c.push(C));continue}if(h==="")continue;let[R,k,y]=T,U=n.slice(a).join("/");if(y instanceof RegExp&&y.test(U)){r.push(...this.gHSets(m.children[R],e)),s[k]=U;continue}(y===!0||y instanceof RegExp&&y.test(h))&&(typeof R=="string"&&(u===!0?r.push(...this.gHSets(m.children[R],e)):c.push(m.children[R])),(typeof k=="string"&&!d||m.children[h])&&(s[k]=h))}}i=c}let o=r.length;return o===0?null:o===1?{handlers:[r[0].handler],params:s}:{handlers:r.sort((a,l)=>a.score-l.score).map(a=>a.handler),params:s}}},_e=class{constructor(){this.name="TrieRouter",this.node=new Y}add(e,t,r){let s=L(t);if(s){for(let i of s)this.node.insert(e,i,r);return}this.node.insert(e,t,r)}match(e,t){return this.node.search(e,t)}},ye=class extends G{constructor(e={}){super(e),this.router=e.router??new we({routers:[new ge,new _e]})}};export{ye as Hono};
//# sourceMappingURL=hono.bundle.mjs.map